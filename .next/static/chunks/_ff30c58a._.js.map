{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/dashboard/layout.tsx"],"sourcesContent":["\n'use client';\n\nimport type { ReactNode } from 'react';\nimport { redirect, usePathname } from 'next/navigation';\nimport { useEffect, useState } from 'react';\nimport type { User as CurrentUserType } from '@/types';\nimport { fetchUserSessionForClient } from '@/app/actions';\nimport { Loader2 as LoaderIcon } from 'lucide-react';\n\nexport default function DashboardLayout({\n  children,\n}: {\n  children: ReactNode;\n}) {\n  const [user, setUser] = useState<CurrentUserType | null>(null);\n  const [loading, setLoading] = useState(true);\n  const pathname = usePathname();\n\n  useEffect(() => {\n    async function fetchSession() {\n      setLoading(true);\n      try {\n        const sessionUser = await fetchUserSessionForClient();\n        // Allow all logged-in users to access the dashboard.\n        // Specific admin functionalities are handled by the /admin route.\n        if (!sessionUser) { \n          redirect(`/login?message=请登录以访问仪表盘&redirect=${pathname}`);\n        } else {\n          setUser(sessionUser);\n        }\n      } catch (error) {\n        console.error(\"Error fetching user session in dashboard layout:\", error);\n        redirect(`/login?message=会话加载失败，请重新登录&redirect=${pathname}`);\n      } finally {\n        setLoading(false);\n      }\n    }\n    fetchSession();\n  }, [pathname]);\n\n  if (loading) {\n    return (\n      <div className=\"flex flex-1 justify-center items-center h-full p-4 bg-background\">\n        <LoaderIcon className=\"h-12 w-12 animate-spin text-primary\" />\n        <p className=\"ml-3 text-lg text-muted-foreground\">正在加载用户数据...</p>\n      </div>\n    );\n  }\n\n  if (!user) {\n    // This case should ideally be handled by the redirect in useEffect,\n    // but as a fallback, show a message.\n    return (\n        <div className=\"flex flex-1 justify-center items-center h-full p-4 bg-background\">\n            <p className=\"text-muted-foreground\">正在重定向到登录页面...</p>\n        </div>\n    );\n  }\n\n  return <>{children}</>;\n}\n\n"],"names":[],"mappings":";;;;AAIA;AACA;AAEA;AACA;;;AAPA;;;;;AASe,SAAS,gBAAgB,EACtC,QAAQ,EAGT;;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAA0B;IACzD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,cAAW,AAAD;IAE3B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;qCAAE;YACR,eAAe;gBACb,WAAW;gBACX,IAAI;oBACF,MAAM,cAAc,MAAM,CAAA,GAAA,wHAAA,CAAA,4BAAyB,AAAD;oBAClD,qDAAqD;oBACrD,kEAAkE;oBAClE,IAAI,CAAC,aAAa;wBAChB,CAAA,GAAA,qIAAA,CAAA,WAAQ,AAAD,EAAE,CAAC,kCAAkC,EAAE,UAAU;oBAC1D,OAAO;wBACL,QAAQ;oBACV;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,oDAAoD;oBAClE,CAAA,GAAA,qIAAA,CAAA,WAAQ,AAAD,EAAE,CAAC,qCAAqC,EAAE,UAAU;gBAC7D,SAAU;oBACR,WAAW;gBACb;YACF;YACA;QACF;oCAAG;QAAC;KAAS;IAEb,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC,oNAAA,CAAA,UAAU;oBAAC,WAAU;;;;;;8BACtB,6LAAC;oBAAE,WAAU;8BAAqC;;;;;;;;;;;;IAGxD;IAEA,IAAI,CAAC,MAAM;QACT,oEAAoE;QACpE,qCAAqC;QACrC,qBACI,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC;gBAAE,WAAU;0BAAwB;;;;;;;;;;;IAG/C;IAEA,qBAAO;kBAAG;;AACZ;GAnDwB;;QAOL,qIAAA,CAAA,cAAW;;;KAPN","debugId":null}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"file":"loader-circle.js","sources":["file:///home/user/studio/node_modules/lucide-react/src/icons/loader-circle.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [['path', { d: 'M21 12a9 9 0 1 1-6.219-8.56', key: '13zald' }]];\n\n/**\n * @component @name LoaderCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTJhOSA5IDAgMSAxLTYuMjE5LTguNTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/loader-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst LoaderCircle = createLucideIcon('LoaderCircle', __iconNode);\n\nexport default LoaderCircle;\n"],"names":[],"mappings":";;;;;;;;;;;AAGa,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,UAAA,CAAuB,CAAA,CAAA;IAAC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ;QAAA,CAAE;YAAA,EAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAA+B;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK,CAAS,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAC;KAAC;CAAA,CAAA;AAa5F,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,YAAA,CAAe,CAAA,2KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAiB,CAAjB,CAAA,AAAiB,CAAjB,AAAiB,CAAjB,AAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAgB,CAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA","ignoreList":[0],"debugId":null}}]
}