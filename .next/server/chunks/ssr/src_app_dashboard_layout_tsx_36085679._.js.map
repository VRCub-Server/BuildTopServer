{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/dashboard/layout.tsx"],"sourcesContent":["\n'use client';\n\nimport type { ReactNode } from 'react';\nimport { redirect } from 'next/navigation';\nimport { useEffect, useState } from 'react';\nimport type { User as CurrentUserType } from '@/types';\nimport { fetchUserSessionForClient } from '@/app/actions'; // Changed to fetchUserSessionForClient\nimport { Loader2 as LoaderIcon } from 'lucide-react';\n\n// This layout is now primarily for session checking and providing the content wrapper.\n// The UnifiedSidebar is handled by the RootLayout.\n\nexport default function DashboardLayout({\n  children,\n}: {\n  children: ReactNode;\n}) {\n  const [user, setUser] = useState<CurrentUserType | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    async function fetchSession() {\n      setLoading(true);\n      try {\n        const sessionUser = await fetchUserSessionForClient();\n        if (!sessionUser) {\n          redirect('/login?message=请先登录以访问仪表盘');\n        } else {\n          setUser(sessionUser);\n        }\n      } catch (error) {\n        console.error(\"Error fetching user session in dashboard layout:\", error);\n        redirect('/login?message=会话加载失败，请重新登录');\n      } finally {\n        setLoading(false);\n      }\n    }\n    fetchSession();\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"flex flex-col flex-1 justify-center items-center min-h-screen bg-background fixed inset-0 z-[100]\">\n        <LoaderIcon className=\"h-16 w-16 animate-spin text-primary\" />\n        <p className=\"mt-4 text-muted-foreground\">正在加载用户数据...</p>\n      </div>\n    );\n  }\n\n  if (!user) {\n    // This case should ideally be handled by the redirect in useEffect,\n    // but as a fallback:\n    return (\n        <div className=\"flex flex-col flex-1 justify-center items-center min-h-screen bg-background\">\n            <p className=\"text-muted-foreground\">正在重定向到登录页面...</p>\n        </div>\n    );\n  }\n\n  // The main content area styling (padding, etc.) is now handled by RootLayout's main tag.\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;AAIA;AACA;AAEA,4MAA2D,uCAAuC;AAClG;AAPA;;;;;;AAYe,SAAS,gBAAgB,EACtC,QAAQ,EAGT;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAA0B;IACzD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,eAAe;YACb,WAAW;YACX,IAAI;gBACF,MAAM,cAAc,MAAM,CAAA,GAAA,qHAAA,CAAA,4BAAyB,AAAD;gBAClD,IAAI,CAAC,aAAa;oBAChB,CAAA,GAAA,kIAAA,CAAA,WAAQ,AAAD,EAAE;gBACX,OAAO;oBACL,QAAQ;gBACV;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,oDAAoD;gBAClE,CAAA,GAAA,kIAAA,CAAA,WAAQ,AAAD,EAAE;YACX,SAAU;gBACR,WAAW;YACb;QACF;QACA;IACF,GAAG,EAAE;IAEL,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;;8BACb,8OAAC,iNAAA,CAAA,UAAU;oBAAC,WAAU;;;;;;8BACtB,8OAAC;oBAAE,WAAU;8BAA6B;;;;;;;;;;;;IAGhD;IAEA,IAAI,CAAC,MAAM;QACT,oEAAoE;QACpE,qBAAqB;QACrB,qBACI,8OAAC;YAAI,WAAU;sBACX,cAAA,8OAAC;gBAAE,WAAU;0BAAwB;;;;;;;;;;;IAG/C;IAEA,yFAAyF;IACzF,qBAAO;kBAAG;;AACZ","debugId":null}}]
}