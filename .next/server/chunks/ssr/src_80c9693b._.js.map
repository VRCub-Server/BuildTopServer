{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,6JACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG3B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,8OAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/dashboard/layout.tsx"],"sourcesContent":["\n'use client';\n\nimport type { ReactNode } from 'react';\nimport { redirect, usePathname } from 'next/navigation'; // Added usePathname\nimport { useEffect, useState } from 'react';\nimport type { User as CurrentUserType } from '@/types';\nimport { fetchUserSessionForClient } from '@/app/actions';\nimport { Loader2 as LoaderIcon } from 'lucide-react';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Button } from '@/components/ui/button';\nimport Link from 'next/link';\n\nexport default function DashboardLayout({\n  children,\n}: {\n  children: ReactNode;\n}) {\n  const [user, setUser] = useState<CurrentUserType | null>(null);\n  const [loading, setLoading] = useState(true);\n  const pathname = usePathname(); // For redirect logic if needed\n\n  useEffect(() => {\n    async function fetchSession() {\n      setLoading(true);\n      try {\n        const sessionUser = await fetchUserSessionForClient();\n        if (!sessionUser) {\n          // Redirect to login, potentially with a message and return path\n          redirect(`/login?message=请先登录以访问仪表盘&returnTo=${encodeURIComponent(pathname)}`);\n        } else {\n          setUser(sessionUser);\n        }\n      } catch (error) {\n        console.error(\"Error fetching user session in dashboard layout:\", error);\n        // Redirect to login with an error message\n        redirect(`/login?message=会话加载失败，请重新登录&returnTo=${encodeURIComponent(pathname)}`);\n      } finally {\n        setLoading(false);\n      }\n    }\n    fetchSession();\n  }, [pathname]);\n\n  if (loading) {\n    // Render a loader *within* the main content area provided by RootLayout\n    return (\n      <div className=\"flex flex-1 justify-center items-center h-full\"> {/* Adjusted to fill available space */}\n        <div className=\"flex flex-col items-center\">\n          <LoaderIcon className=\"h-12 w-12 animate-spin text-primary\" />\n          <p className=\"mt-4 text-muted-foreground\">正在加载用户数据...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    // This state should ideally be handled by the redirect in useEffect.\n    // If somehow reached, show a message within the layout.\n    return (\n      <div className=\"flex flex-1 justify-center items-center h-full\">\n        <Alert variant=\"destructive\" className=\"max-w-md\">\n          <AlertTitle>未授权</AlertTitle>\n          <AlertDescription>\n            您需要登录才能访问此页面。正在尝试重定向...\n            <Link href={`/login?returnTo=${encodeURIComponent(pathname)}`} className=\"block mt-2\">\n              <Button variant=\"outline\">前往登录</Button>\n            </Link>\n          </AlertDescription>\n        </Alert>\n      </div>\n    );\n  }\n\n  // User is authenticated, render the actual dashboard children\n  // The RootLayout already provides the main page structure (sidebar, main content wrapper)\n  // This component just provides its children, which will be placed into RootLayout's main content area.\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;AAIA,sOAAyD,oBAAoB;AAC7E;AAEA;AACA;AACA;AACA;AACA;AAVA;;;;;;;;;AAYe,SAAS,gBAAgB,EACtC,QAAQ,EAGT;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAA0B;IACzD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD,KAAK,+BAA+B;IAE/D,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,eAAe;YACb,WAAW;YACX,IAAI;gBACF,MAAM,cAAc,MAAM,CAAA,GAAA,qHAAA,CAAA,4BAAyB,AAAD;gBAClD,IAAI,CAAC,aAAa;oBAChB,gEAAgE;oBAChE,CAAA,GAAA,kIAAA,CAAA,WAAQ,AAAD,EAAE,CAAC,mCAAmC,EAAE,mBAAmB,WAAW;gBAC/E,OAAO;oBACL,QAAQ;gBACV;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,oDAAoD;gBAClE,0CAA0C;gBAC1C,CAAA,GAAA,kIAAA,CAAA,WAAQ,AAAD,EAAE,CAAC,qCAAqC,EAAE,mBAAmB,WAAW;YACjF,SAAU;gBACR,WAAW;YACb;QACF;QACA;IACF,GAAG;QAAC;KAAS;IAEb,IAAI,SAAS;QACX,wEAAwE;QACxE,qBACE,8OAAC;YAAI,WAAU;;gBAAiD;8BAC9D,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,iNAAA,CAAA,UAAU;4BAAC,WAAU;;;;;;sCACtB,8OAAC;4BAAE,WAAU;sCAA6B;;;;;;;;;;;;;;;;;;IAIlD;IAEA,IAAI,CAAC,MAAM;QACT,qEAAqE;QACrE,wDAAwD;QACxD,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,iIAAA,CAAA,QAAK;gBAAC,SAAQ;gBAAc,WAAU;;kCACrC,8OAAC,iIAAA,CAAA,aAAU;kCAAC;;;;;;kCACZ,8OAAC,iIAAA,CAAA,mBAAgB;;4BAAC;0CAEhB,8OAAC,4JAAA,CAAA,UAAI;gCAAC,MAAM,CAAC,gBAAgB,EAAE,mBAAmB,WAAW;gCAAE,WAAU;0CACvE,cAAA,8OAAC,kIAAA,CAAA,SAAM;oCAAC,SAAQ;8CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMtC;IAEA,8DAA8D;IAC9D,0FAA0F;IAC1F,uGAAuG;IACvG,qBAAO;kBAAG;;AACZ","debugId":null}}]
}